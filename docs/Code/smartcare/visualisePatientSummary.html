<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of visualisePatientSummary</title>
  <meta name="keywords" content="visualisePatientSummary">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">Code</a> &gt; <a href="index.html">smartcare</a> &gt; visualisePatientSummary.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for Code/smartcare&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>visualisePatientSummary
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../Code/pdm/helperfunctions/cleanDrugTherapyNamings.html" class="code" title="function out = cleanDrugTherapyNamings(str_array)">cleanDrugTherapyNamings</a>	useful only for pre-REDCAP update datasets</li><li><a href="cleanDrugTherapyNamings.html" class="code" title="function out = cleanDrugTherapyNamings(str_array)">cleanDrugTherapyNamings</a>	inputs: array, output: array with cleaned drugtherapy names</li><li><a href="createFigureAndPanel.html" class="code" title="function [f, p] = createFigureAndPanel(name, orientation, pagesize)">createFigureAndPanel</a>	createFigureAndPanel - creates a figure with a ui panel and returns</li><li><a href="getColumnForMeasure.html" class="code" title="function [column] = getColumnForMeasure(measure)">getColumnForMeasure</a>	getColumnForMeasure - returns the column name from physdata for the</li><li><a href="getPatientOffsets.html" class="code" title="function [patientoffsettable] = getPatientOffsets(physdata)">getPatientOffsets</a>	gets the patient offset table</li><li><a href="getRawDataFilenamesForStudy.html" class="code" title="function [datamatfile, clinicalmatfile, demographicsmatfile] = getRawDataFilenamesForStudy(study)">getRawDataFilenamesForStudy</a>	getRawDataFilenamesForStudy - return filenames for raw data files for</li><li><a href="loadAndHarmoniseClinVars.html" class="code" title="function [cdPatient, cdDrugTherapy, cdMicrobiology, cdAntibiotics, cdAdmissions, cdPFT, cdCRP,cdClinicVisits, cdOtherVisits, cdEndStudy, cdHghtWght, cdMedications, cdNewMeds, cdUnplannedContact]= loadAndHarmoniseClinVars(clinicalmatfile, subfolder, study)">loadAndHarmoniseClinVars</a>	loadAndHarmoniseClinVars - loads clinical variables and standardises</li><li><a href="loadAndHarmoniseMeasVars.html" class="code" title="function [physdata, offset, physdata_predateoutlierhandling] = loadAndHarmoniseMeasVars(datamatfile, subfolder, study)">loadAndHarmoniseMeasVars</a>	loadAndHarmoniseMeasVars - loads raw measurement variables and standardises</li><li><a href="mid50max.html" class="code" title="function y = mid50max(x)">mid50max</a>	mid50std - returns the std of the mid 50% data points in x (sorted by</li><li><a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>	mid50mean - returns the mean of the mid 50% data points in x (sorted by</li><li><a href="mid50min.html" class="code" title="function y = mid50min(x)">mid50min</a>	mid50std - returns the std of the mid 50% data points in x (sorted by</li><li><a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a>	mid50std - returns the std of the mid 50% data points in x (sorted by</li><li><a href="savePlotInDir.html" class="code" title="function savePlotInDir(f, name, subfolder)">savePlotInDir</a>	savePlots - saves the figure to png and svp file types in the specified</li><li><a href="selectStudy.html" class="code" title="function [studynbr, study, studyfullname] = selectStudy()">selectStudy</a>	selectStudy - choose which study to run for</li><li><a href="setBaseDir.html" class="code" title="function [basedir] = setBaseDir()">setBaseDir</a>	setBaseDir - sets the root directory for the code, plots, data files etc</li><li><a href="setMinYDisplayRangeForMeasure.html" class="code" title="function [range] = setMinYDisplayRangeForMeasure(measure)">setMinYDisplayRangeForMeasure</a>	setMinYDisplayRangeForMeasure - sets the minimum range for Y axis for</li><li><a href="setYDisplayRange.html" class="code" title="function [roundedrange] = setYDisplayRange(miny, maxy, lowrangelimit)">setYDisplayRange</a>	setYDisplayRange - function to scale y axis of plots appropriately</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 clc; clear; close all;
0002 
0003 basedir = <a href="setBaseDir.html" class="code" title="function [basedir] = setBaseDir()">setBaseDir</a>();
0004 subfolder = <span class="string">'MatlabSavedVariables'</span>;
0005 
0006 [studynbr, study, ~] = <a href="selectStudy.html" class="code" title="function [studynbr, study, studyfullname] = selectStudy()">selectStudy</a>();
0007 [datamatfile, clinicalmatfile, demographicsmatfile] = <a href="getRawDataFilenamesForStudy.html" class="code" title="function [datamatfile, clinicalmatfile, demographicsmatfile] = getRawDataFilenamesForStudy(study)">getRawDataFilenamesForStudy</a>(study);
0008 [physdata, offset, physdata_predateoutlierhandling] = <a href="loadAndHarmoniseMeasVars.html" class="code" title="function [physdata, offset, physdata_predateoutlierhandling] = loadAndHarmoniseMeasVars(datamatfile, subfolder, study)">loadAndHarmoniseMeasVars</a>(datamatfile, subfolder, study);
0009 [cdPatient, cdDrugTherapy, cdMicrobiology, cdAntibiotics, cdAdmissions, cdPFT, cdCRP, <span class="keyword">...</span>
0010     cdClinicVisits, cdOtherVisits, cdEndStudy, cdHghtWght] = <a href="loadAndHarmoniseClinVars.html" class="code" title="function [cdPatient, cdDrugTherapy, cdMicrobiology, cdAntibiotics, cdAdmissions, cdPFT, cdCRP,cdClinicVisits, cdOtherVisits, cdEndStudy, cdHghtWght, cdMedications, cdNewMeds, cdUnplannedContact]= loadAndHarmoniseClinVars(clinicalmatfile, subfolder, study)">loadAndHarmoniseClinVars</a>(clinicalmatfile, subfolder, study);
0011 
0012 <span class="comment">% Tristan's function to harmonise drug therapy namings - temporary until</span>
0013 <span class="comment">% REDcap is active</span>
0014 cdDrugTherapy.DrugTherapyType = <a href="cleanDrugTherapyNamings.html" class="code" title="function out = cleanDrugTherapyNamings(str_array)">cleanDrugTherapyNamings</a>(cdDrugTherapy.DrugTherapyType);
0015 
0016 tic
0017 fprintf(<span class="string">'Loading demographic data by patient\n'</span>);
0018 load(fullfile(basedir, subfolder, demographicsmatfile), <span class="string">'demographicstable'</span>, <span class="string">'overalltable'</span>);
0019 toc
0020 fprintf(<span class="string">'\n'</span>);
0021 
0022 subfolder = sprintf(<span class="string">'Plots/%s'</span>, study);
0023 <span class="keyword">if</span> ~exist(strcat(basedir, subfolder), <span class="string">'dir'</span>)
0024     mkdir(strcat(basedir, subfolder));
0025 <span class="keyword">end</span>
0026 
0027 runmode = input(<span class="string">'Which patients to run for 1) Those with enough data 2) Those without enough data ?'</span>);
0028 <span class="keyword">if</span> runmode ~= 1 &amp; runmode ~= 2
0029     fprintf(<span class="string">'Invalid entry'</span>)
0030     <span class="keyword">return</span>;
0031 <span class="keyword">end</span>
0032 
0033 <span class="keyword">if</span> runmode == 1
0034     patientlist = unique(physdata.SmartCareID);
0035 <span class="keyword">elseif</span> runmode == 2
0036     goodpatients = unique(physdata.SmartCareID);
0037     patientlist = unique(physdata_predateoutlierhandling.SmartCareID(~ismember(physdata_predateoutlierhandling.SmartCareID, goodpatients)));
0038     physdata = physdata_predateoutlierhandling;
0039 <span class="keyword">end</span>
0040 
0041 patientoffsets = <a href="getPatientOffsets.html" class="code" title="function [patientoffsettable] = getPatientOffsets(physdata)">getPatientOffsets</a>(physdata);
0042 cvcol   = [0.94  0.52  0.15];
0043 admcol  = [0.694 0.627 0.78]; 
0044 ivcol   = [1     0     0   ];
0045 oralcol = [1     0.85  0   ];
0046 trplcol = [0     1     0   ];
0047 drugcol = [0     0.8   0.6 ];
0048 
0049 <span class="keyword">for</span> i = 1:size(patientlist,1)
0050 <span class="comment">%for i = 59:59</span>
0051 <span class="comment">%for i = 1:4</span>
0052     tic
0053     scid       = patientlist(i);
0054     fprintf(<span class="string">'Creating patient summary for patient %d\n'</span>, scid);
0055     poffset    = patientoffsets.PatientOffset(patientoffsets.SmartCareID == scid);
0056     studyid   = cdPatient.StudyNumber{cdPatient.ID == scid};
0057     hospital   = cdPatient.Hospital{cdPatient.ID == scid};
0058     sex        = cdPatient.Sex{cdPatient.ID == scid};
0059     spstart    = cdPatient.StudyDate(cdPatient.ID == scid);
0060     spstartdn  = datenum(spstart) - offset - poffset + 1;
0061     spend      = cdPatient.StudyDate(cdPatient.ID == scid)+days(183);
0062     spenddn    = spstartdn + 183;
0063     <span class="keyword">if</span> studynbr == 3 || studynbr == 4
0064         spendstatus = <span class="string">' '</span>;
0065     <span class="keyword">else</span>
0066         spendstatus = cdEndStudy.EndOfStudyReason{cdEndStudy.ID == scid};
0067     <span class="keyword">end</span>
0068     hmstart    = min(physdata.Date_TimeRecorded(physdata.SmartCareID == scid));
0069     hmstartdn  = min(physdata.ScaledDateNum(physdata.SmartCareID == scid));
0070     hmend      = max(physdata.Date_TimeRecorded(physdata.SmartCareID == scid));
0071     hmenddn    = max(physdata.ScaledDateNum(physdata.SmartCareID == scid));
0072     
0073     spclinicvisits  = size(cdClinicVisits.ID(cdClinicVisits.ID == scid &amp; cdClinicVisits.AttendanceDate &gt;= spstart &amp; cdClinicVisits.AttendanceDate &lt;= spend),1);
0074     sphospadm       = size(cdAdmissions.ID(cdAdmissions.ID == scid &amp; cdAdmissions.Admitted &gt;= spstart &amp; cdAdmissions.Admitted &lt;= spend),1);
0075     spivab          = size(cdAntibiotics.ID(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, <span class="string">'IV'</span>) &amp; cdAntibiotics.StartDate &gt;= spstart &amp; cdAntibiotics.StartDate &lt;= spend),1);
0076     sporalab        = size(cdAntibiotics.ID(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, <span class="string">'Oral'</span>) &amp; cdAntibiotics.StartDate &gt;= spstart &amp; cdAntibiotics.StartDate &lt;= spend),1);
0077     spcpftmeas      = size(cdPFT.ID(cdPFT.ID == scid &amp; cdPFT.LungFunctionDate &gt;= spstart &amp; cdPFT.LungFunctionDate &lt;= spend),1);
0078     spccrpmeas      = size(cdCRP.ID(cdCRP.ID == scid &amp; cdCRP.CRPDate &gt;= spstart &amp; cdCRP.CRPDate &lt;= spend),1);
0079     
0080     hmclinicvisits  = size(cdClinicVisits.ID(cdClinicVisits.ID == scid &amp; cdClinicVisits.AttendanceDate &gt;= hmstart &amp; cdClinicVisits.AttendanceDate &lt;= hmend),1);
0081     hmhospadm       = size(cdAdmissions.ID(cdAdmissions.ID == scid &amp; cdAdmissions.Admitted &gt;= hmstart &amp; cdAdmissions.Admitted &lt;= hmend),1);
0082     hmivab          = size(cdAntibiotics.ID(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, <span class="string">'IV'</span>) &amp; cdAntibiotics.StartDate &gt;= hmstart &amp; cdAntibiotics.StartDate &lt;= hmend),1);
0083     hmoralab        = size(cdAntibiotics.ID(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, <span class="string">'Oral'</span>) &amp; cdAntibiotics.StartDate &gt;= hmstart &amp; cdAntibiotics.StartDate &lt;= hmend),1);
0084     hmcpftmeas      = size(cdPFT.ID(cdPFT.ID == scid &amp; cdPFT.LungFunctionDate &gt;= hmstart &amp; cdPFT.LungFunctionDate &lt;= hmend),1);
0085     hmccrpmeas      = size(cdCRP.ID(cdCRP.ID == scid &amp; cdCRP.CRPDate &gt;= hmstart &amp; cdCRP.CRPDate &lt;= hmend),1);
0086     
0087     allclinicvisits = size(cdClinicVisits.ID(cdClinicVisits.ID == scid),1);
0088     allhospadm      = size(cdAdmissions.ID(cdAdmissions.ID == scid),1);
0089     allcpftmeas     = size(cdPFT.ID(cdPFT.ID == scid),1);
0090     allccrpmeas     = size(cdCRP.ID(cdCRP.ID == scid),1);
0091     allivab         = size(cdAntibiotics.ID(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, <span class="string">'IV'</span>)),1);
0092     alloralab       = size(cdAntibiotics.ID(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, <span class="string">'Oral'</span>)),1);
0093     
0094     allcavgfev1     = mean(cdPFT.FEV1(cdPFT.ID == scid));
0095     allcstdfev1     = std(cdPFT.FEV1(cdPFT.ID == scid));
0096     allcminfev1     = min(cdPFT.FEV1(cdPFT.ID == scid));
0097     allcmaxfev1     = max(cdPFT.FEV1(cdPFT.ID == scid));
0098     
0099     allcavgfev1_    = mean(cdPFT.CalcFEV1_(cdPFT.ID == scid));
0100     allcstdfev1_    = std (cdPFT.CalcFEV1_(cdPFT.ID == scid));
0101     allcminfev1_    = min(cdPFT.CalcFEV1_(cdPFT.ID == scid));
0102     allcmaxfev1_    = max(cdPFT.CalcFEV1_(cdPFT.ID == scid));
0103     
0104     allcavgcrp      = mean(cdCRP.NumericLevel(cdCRP.ID == scid));
0105     allcstdcrp      = std(cdCRP.NumericLevel(cdCRP.ID == scid));
0106     allcmincrp      = min(cdCRP.NumericLevel(cdCRP.ID == scid));
0107     allcmaxcrp      = max(cdCRP.NumericLevel(cdCRP.ID == scid));
0108     
0109     hmtotal         = size(physdata.SmartCareID(physdata.SmartCareID == scid),1);
0110     hmduration      = max(physdata.DateNum(physdata.SmartCareID == scid)) - min(physdata.DateNum(physdata.SmartCareID == scid));
0111     hmavgperday     = hmtotal/hmduration;
0112     
0113     leftstring = [  {sprintf(<span class="string">'                Study Info'</span>)}                                                               ; <span class="keyword">...</span>
0114                     {sprintf(<span class="string">'------------------------------------------'</span>)}                                               ; <span class="keyword">...</span>
0115                     {sprintf(<span class="string">'Patient ID       :  %d'</span>, scid)}                                                             ; <span class="keyword">...</span>
0116                     {sprintf(<span class="string">'Study ID         :  %s'</span>, studyid)}                                                         ; <span class="keyword">...</span>
0117                     {sprintf(<span class="string">'Hospital         :  %s'</span>, hospital)}                                                         ; <span class="keyword">...</span>
0118                     {sprintf(<span class="string">'Study Start Date :  %s'</span>, datestr(spstart,1))}                                               ; <span class="keyword">...</span>
0119                     {sprintf(<span class="string">'Study End Date   :  %s'</span>, datestr((spend),1))}                                               ; <span class="keyword">...</span>
0120                     {sprintf(<span class="string">'Study Status     :  %s'</span>, spendstatus)}                                                      ; <span class="keyword">...</span>
0121                     {sprintf(<span class="string">' '</span>)}                                                                                        ; <span class="keyword">...</span>
0122                     {sprintf(<span class="string">'              Clinical Data'</span>)}                                                              ; <span class="keyword">...</span>
0123                     {sprintf(<span class="string">'   StudyPeriod (HomeMeasurePeriod, All)'</span>)}                                                  ; <span class="keyword">...</span>
0124                     {sprintf(<span class="string">'------------------------------------------'</span>)}                                               ; <span class="keyword">...</span>
0125                     {sprintf(<span class="string">'Hospital Admissions   :  %2d (%2d,%2d)'</span>, sphospadm, hmhospadm, allhospadm)}                   ; <span class="keyword">...</span>
0126                     {sprintf(<span class="string">'Antibiotics - IV      :  %2d (%2d,%2d)'</span>, spivab, hmivab, allivab)}                            ; <span class="keyword">...</span>
0127                     {sprintf(<span class="string">'Antibiotics - Oral    :  %2d (%2d,%2d)'</span>, sporalab, hmoralab, alloralab)}                      ; <span class="keyword">...</span>
0128                     {sprintf(<span class="string">'Clinic Visits         :  %2d (%2d,%2d)'</span>, spclinicvisits, hmclinicvisits, allclinicvisits )}   ; <span class="keyword">...</span>
0129                     {sprintf(<span class="string">'Clinical PFT Measures :  %2d (%2d,%2d)'</span>, spcpftmeas, hmcpftmeas, allcpftmeas)}                ; <span class="keyword">...</span>
0130                     {sprintf(<span class="string">'Clinical CRP Measures :  %2d (%2d,%2d)'</span>, spccrpmeas, hmccrpmeas, allccrpmeas)}                ; <span class="keyword">...</span>
0131                     {sprintf(<span class="string">' '</span>)}                                                                                        ; <span class="keyword">...</span>
0132                     {sprintf(<span class="string">'            Clinical Measures'</span>)}                                                            ; <span class="keyword">...</span>
0133                     {sprintf(<span class="string">'          Avg +/- Std (Min, Max)'</span>)}                                                         ; <span class="keyword">...</span>
0134                     {sprintf(<span class="string">'------------------------------------------'</span>)}                                                ; <span class="keyword">...</span>
0135                     {sprintf(<span class="string">'FEV1      : %4.1f  +/- %4.1f  (%4.1f, %4.1f)'</span>, allcavgfev1, allcstdfev1, allcminfev1, allcmaxfev1)} ; <span class="keyword">...</span>
0136                     {sprintf(<span class="string">'FEV1%%     : %4.1f%% +/- %4.1f%% (%3.0f%%, %3.0f%%)'</span>, allcavgfev1_, allcstdfev1_, allcminfev1_, allcmaxfev1_)} ; <span class="keyword">...</span>
0137                     {sprintf(<span class="string">'CRP Level : %4.1f  +/- %4.1f  (%4.1f, %4.1f)'</span>, allcavgcrp, allcstdcrp, allcmincrp, allcmaxcrp)}     ; <span class="keyword">...</span>
0138                     {sprintf(<span class="string">' '</span>)}                                                                                        ; <span class="keyword">...</span>
0139                     {sprintf(<span class="string">'              Microbiology'</span>)}                                                               ; <span class="keyword">...</span>
0140                     {sprintf(<span class="string">'------------------------------------------'</span>)}                                                ; <span class="keyword">...</span>
0141                   ];
0142                                                    
0143     microbiology = unique(cdMicrobiology.Microbiology(cdMicrobiology.ID==scid));
0144     <span class="keyword">for</span> m = 1:size(microbiology,1)
0145         rowstring = sprintf(<span class="string">'%s'</span>, microbiology{m});
0146         leftstring = [leftstring ; rowstring];
0147     <span class="keyword">end</span>
0148     
0149     rightstring = [ {sprintf(<span class="string">'                 Patient Data'</span>)}                                                            ; <span class="keyword">...</span>
0150                     {sprintf(<span class="string">'----------------------------------------------'</span>)}                                           ; <span class="keyword">...</span>
0151                     {sprintf(<span class="string">'Sex                    :  %s'</span>       , cdPatient.Sex{cdPatient.ID == scid})}                 ; <span class="keyword">...</span>
0152                     {sprintf(<span class="string">'D.O.B                  :  %s'</span>       , datestr(cdPatient.DOB(cdPatient.ID == scid),1))}      ; <span class="keyword">...</span>
0153                     {sprintf(<span class="string">'Age                    :  %d'</span>       , cdPatient.CalcAge(cdPatient.ID == scid))}             ; <span class="keyword">...</span>
0154                     {sprintf(<span class="string">'Height                 :  %1.1f cm'</span> , cdPatient.Height(cdPatient.ID == scid))}              ; <span class="keyword">...</span>
0155                     {sprintf(<span class="string">'Weight                 :  %1.1f kg'</span> , cdPatient.Weight(cdPatient.ID == scid))}              ; <span class="keyword">...</span>
0156                     {sprintf(<span class="string">'Predicted FEV1         :  %1.1f ltr'</span>, cdPatient.CalcFEV1SetAs(cdPatient.ID == scid))}       ; <span class="keyword">...</span>
0157                     {sprintf(<span class="string">' '</span>)}                                                                                        ; <span class="keyword">...</span>
0158                     {sprintf(<span class="string">'            Home Measurement Data'</span>)}                                                        ; <span class="keyword">...</span>
0159                     {sprintf(<span class="string">'----------------------------------------------'</span>)}                                           ; <span class="keyword">...</span>
0160                     {sprintf(<span class="string">'Measurement Start      :  %s'</span>      , datestr(hmstart,1))}                                   ; <span class="keyword">...</span>
0161                     {sprintf(<span class="string">'Measurement End        :  %s'</span>      , datestr(hmend,1))}                                     ; <span class="keyword">...</span>
0162                     {sprintf(<span class="string">'Duration               :  %d days'</span> , hmduration)}                                           ; <span class="keyword">...</span>
0163                     {sprintf(<span class="string">'Total Measures         :  %d'</span>      , hmtotal)}                                              ; <span class="keyword">...</span>
0164                     {sprintf(<span class="string">'Avg Measures Per Day   :  %1.1f'</span>   , hmavgperday)}                                          ; <span class="keyword">...</span>
0165                     {sprintf(<span class="string">' '</span>)}                                                                                        ; <span class="keyword">...</span>
0166                     {sprintf(<span class="string">'              Home Measures'</span>)}                                                              ; <span class="keyword">...</span>
0167                     {sprintf(<span class="string">'          Avg +/- Std (Min, Max)'</span>)}                                                         ; <span class="keyword">...</span>
0168                     {sprintf(<span class="string">'----------------------------------------------'</span>)}                                           ; <span class="keyword">...</span>
0169                   ];
0170               
0171     measures = unique(physdata.RecordingType(physdata.SmartCareID == scid));
0172     <span class="keyword">for</span> m = 1:size(measures,1)
0173         measure = measures{m};
0174         column = <a href="getColumnForMeasure.html" class="code" title="function [column] = getColumnForMeasure(measure)">getColumnForMeasure</a>(measure);
0175         ddcolumn = sprintf(<span class="string">'Fun_%s'</span>,column);
0176         mmean = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(1);
0177         mstd  = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(2);
0178         mmin  = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(3);
0179         mmax  = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(4);
0180         <span class="keyword">if</span> ismember(measure, <span class="string">'ActivityRecording'</span>)
0181             rowstring = sprintf(<span class="string">'%-13s : %5.0f +/- %5.0f (%5.0f, %5.0f)'</span>, replace(measure, <span class="string">'Recording'</span>, <span class="string">''</span>), mmean, mstd, mmin, mmax);
0182         <span class="keyword">else</span>
0183             rowstring = sprintf(<span class="string">'%-13s : %5.1f +/- %5.1f (%5.1f, %5.1f)'</span>, replace(measure, <span class="string">'Recording'</span>, <span class="string">''</span>), mmean, mstd, mmin, mmax);
0184         <span class="keyword">end</span>
0185         rightstring = [rightstring ; rowstring];
0186     <span class="keyword">end</span>
0187     
0188     rightstring = [rightstring ;
0189                     {sprintf(<span class="string">' '</span>)}                                           ; <span class="keyword">...</span>
0190                     {sprintf(<span class="string">'       Mid 50%% Avg +/- Std (Min, Max)'</span>)}      ; <span class="keyword">...</span>
0191                     {sprintf(<span class="string">'----------------------------------------------'</span>)} ];
0192                 
0193     <span class="keyword">for</span> m = 1:size(measures,1)
0194         measure = measures{m};
0195         column = <a href="getColumnForMeasure.html" class="code" title="function [column] = getColumnForMeasure(measure)">getColumnForMeasure</a>(measure);
0196         ddcolumn  = sprintf(<span class="string">'Fun_%s'</span>,column);
0197         <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a> = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(5);
0198         <a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a>  = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(6);
0199         <a href="mid50min.html" class="code" title="function y = mid50min(x)">mid50min</a>  = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(7);
0200         <a href="mid50max.html" class="code" title="function y = mid50max(x)">mid50max</a>  = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(8);
0201         <span class="keyword">if</span> ismember(measure, <span class="string">'ActivityRecording'</span>)
0202             rowstring = sprintf(<span class="string">'%-13s : %5.0f +/- %5.0f (%5.0f, %5.0f)'</span>, replace(measure, <span class="string">'Recording'</span>, <span class="string">''</span>), <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>, <a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a>, <a href="mid50min.html" class="code" title="function y = mid50min(x)">mid50min</a>, <a href="mid50max.html" class="code" title="function y = mid50max(x)">mid50max</a>);
0203         <span class="keyword">else</span>
0204             rowstring = sprintf(<span class="string">'%-13s : %5.1f +/- %5.1f (%5.1f, %5.1f)'</span>, replace(measure, <span class="string">'Recording'</span>, <span class="string">''</span>), <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>, <a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a>, <a href="mid50min.html" class="code" title="function y = mid50min(x)">mid50min</a>, <a href="mid50max.html" class="code" title="function y = mid50max(x)">mid50max</a>);
0205         <span class="keyword">end</span>
0206         rightstring = [rightstring ; rowstring];
0207     <span class="keyword">end</span>
0208     
0209     cplotsacross = 1;
0210     cplotsdown = 3;
0211     
0212     mplotsacross = 1;
0213     mplotsdown = 6;
0214     mplotsperpage = mplotsacross * mplotsdown;
0215     
0216     measures = unique(physdata.RecordingType);
0217     npages = ceil(size(measures, 1) / mplotsperpage) + 1;
0218     page = 1;
0219     filenameprefix = sprintf(<span class="string">'%s-Patient Summary - ID %d (%s) Hosp %s'</span>, study, scid, studyid, hospital);
0220     imagefilename = sprintf(<span class="string">'%s - Page %d of %d'</span>, filenameprefix, page, npages);
0221     [f, p] = <a href="createFigureAndPanel.html" class="code" title="function [f, p] = createFigureAndPanel(name, orientation, pagesize)">createFigureAndPanel</a>(imagefilename, <span class="string">'Portrait'</span>, <span class="string">'a4'</span>);
0222     
0223     sp1 = uicontrol(<span class="string">'Parent'</span>, p, <span class="keyword">...</span><span class="comment"> </span>
0224                     <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="keyword">...</span>
0225                     <span class="string">'OuterPosition'</span>, [0.02, 0.45, 0.48, 0.54], <span class="keyword">...</span>
0226                     <span class="string">'Style'</span>, <span class="string">'text'</span>, <span class="keyword">...</span>
0227                     <span class="string">'FontName'</span>, <span class="string">'FixedWidth'</span>, <span class="keyword">...</span>
0228                     <span class="string">'FontSize'</span>, 8, <span class="keyword">...</span>
0229                     <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="keyword">...</span>
0230                     <span class="string">'HorizontalAlignment'</span>, <span class="string">'left'</span>, <span class="keyword">...</span>
0231                     <span class="string">'BackgroundColor'</span>, <span class="string">'white'</span>, <span class="keyword">...</span>
0232                     <span class="string">'String'</span>, leftstring);
0233     sp2 = uicontrol(<span class="string">'Parent'</span>, p, <span class="keyword">...</span><span class="comment"> </span>
0234                     <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="keyword">...</span>
0235                     <span class="string">'OuterPosition'</span>, [0.5, 0.45, 0.5, 0.54], <span class="keyword">...</span>
0236                     <span class="string">'Style'</span>, <span class="string">'text'</span>, <span class="keyword">...</span>
0237                     <span class="string">'FontName'</span>, <span class="string">'FixedWidth'</span>, <span class="keyword">...</span>
0238                     <span class="string">'FontSize'</span>, 8, <span class="keyword">...</span>
0239                     <span class="string">'FontWeight'</span>, <span class="string">'bold'</span>, <span class="keyword">...</span>
0240                     <span class="string">'HorizontalAlignment'</span>, <span class="string">'left'</span>, <span class="keyword">...</span>
0241                     <span class="string">'BackgroundColor'</span>, <span class="string">'white'</span>, <span class="keyword">...</span>
0242                     <span class="string">'String'</span>, rightstring);
0243     sp3 = uipanel(<span class="string">'Parent'</span>, p, <span class="keyword">...</span>
0244                   <span class="string">'BorderType'</span>, <span class="string">'none'</span>, <span class="keyword">...</span>
0245                   <span class="string">'BackgroundColor'</span>, <span class="string">'white'</span>, <span class="keyword">...</span>
0246                   <span class="string">'OuterPosition'</span>, [0.0, 0.0, 1.0, 0.45]);
0247     
0248     
0249     
0250     daysfrom = min(spstartdn, hmstartdn) - 14;
0251     daysto   = max(spenddn, hmenddn) + 14;
0252     xl = [daysfrom daysto];
0253     
0254     ax = subplot(cplotsdown, cplotsacross, 1,<span class="string">'Parent'</span>,sp3);
0255     hold on;
0256     title(ax, <span class="string">'Clinic Visits ({\color[rgb]{0.5 0.33 0}br}), Admissions ({\color[rgb]{0.694 0.627 0.78}p}), IV ({\color[rgb]{1 0 0}r}) and Oral ({\color[rgb]{1 0.85 0}y}) Antibiotics, Triple Therapy ({\color[rgb]{0 1 0}g}) and Other Therapies ({\color[rgb]{0 0.8 0.6}g})'</span>);
0257     xlabel(ax, <span class="string">'Days'</span>);
0258     ylabel(ax, <span class="string">'Event'</span>);
0259     xlim(xl);
0260     yl = [0 5];
0261     ylim(yl);
0262     linewidth = 8;
0263     
0264     cvset     = cdClinicVisits(cdClinicVisits.ID == scid,:);
0265     cvset.AttendanceDatedn = datenum(cvset.AttendanceDate) - offset - poffset + 1;
0266     <span class="keyword">for</span> a = 1:size(cvset,1)
0267         line(ax, [cvset.AttendanceDatedn(a) cvset.AttendanceDatedn(a) + 1], [4.5, 4.5], <span class="string">'Color'</span>, cvcol, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'LineWidth'</span>, linewidth);
0268     <span class="keyword">end</span>
0269     admset    = cdAdmissions(cdAdmissions.ID == scid,:);
0270     admset.Admitteddn = datenum(admset.Admitted) - offset - poffset + 1;
0271     admset.Dischargedn = datenum(admset.Discharge) - offset - poffset + 1;
0272     admdates = unique([admset.Admitteddn ; admset.Dischargedn]);
0273     <span class="keyword">for</span> a = 1:size(admset,1)
0274         line(ax, [admset.Admitteddn(a) admset.Dischargedn(a)], [3.5, 3.5], <span class="string">'Color'</span>, admcol, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'LineWidth'</span>, linewidth);
0275     <span class="keyword">end</span>
0276     ivabset   = cdAntibiotics(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, {<span class="string">'IV'</span>}),:);
0277     ivabset.Startdn = datenum(ivabset.StartDate) - offset - poffset + 1;
0278     ivabset.Stopdn = datenum(ivabset.StopDate) - offset - poffset + 1;
0279     <span class="keyword">for</span> a = 1:size(ivabset,1)
0280         line(ax, [ivabset.Startdn(a) ivabset.Stopdn(a)], [2.5, 2.5], <span class="string">'Color'</span>, ivcol, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'LineWidth'</span>, linewidth);
0281     <span class="keyword">end</span>
0282     oralabset = cdAntibiotics(cdAntibiotics.ID == scid &amp; ismember(cdAntibiotics.Route, {<span class="string">'Oral'</span>}),:);
0283     oralabset.Startdn = datenum(oralabset.StartDate) - offset - poffset + 1;
0284     oralabset.Stopdn = datenum(oralabset.StopDate) - offset - poffset + 1;
0285     <span class="keyword">for</span> a = 1:size(oralabset,1)
0286         line(ax, [oralabset.Startdn(a) oralabset.Stopdn(a)], [1.5, 1.5], <span class="string">'Color'</span>, oralcol, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'LineWidth'</span>, linewidth);
0287     <span class="keyword">end</span>
0288     trplset = cdDrugTherapy(cdDrugTherapy.ID == scid &amp; contains(cdDrugTherapy.DrugTherapyType, {<span class="string">'Triple Therapy'</span>}),:);
0289     trplset.Startdn = datenum(trplset.DrugTherapyStartDate) - offset - poffset + 1;
0290     <span class="keyword">for</span> a = 1:size(trplset,1)
0291         line(ax, [trplset.Startdn(a) trplset.Startdn(a) + 1], [0.5, 0.5], <span class="string">'Color'</span>, trplcol, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'LineWidth'</span>, linewidth);
0292     <span class="keyword">end</span>
0293     drugset = cdDrugTherapy(cdDrugTherapy.ID == scid &amp; ~contains(cdDrugTherapy.DrugTherapyType, {<span class="string">'Triple Therapy'</span>}),:);
0294     drugset.Startdn = datenum(drugset.DrugTherapyStartDate) - offset - poffset + 1;
0295     <span class="keyword">for</span> a = 1:size(drugset,1)
0296         line(ax, [drugset.Startdn(a) drugset.Startdn(a) + 1], [0.5, 0.5], <span class="string">'Color'</span>, drugcol, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="string">'LineWidth'</span>, linewidth);
0297     <span class="keyword">end</span>
0298     hold off;
0299     
0300     ax = subplot(cplotsdown, cplotsacross, 2,<span class="string">'Parent'</span>,sp3);
0301     pcrp = cdCRP(cdCRP.ID == scid,:);
0302     pcrp.ScaledDateNum = datenum(pcrp.CRPDate) - offset - poffset + 1;
0303     <span class="keyword">if</span> size(pcrp,1) &gt; 0
0304         hold on;
0305         plot(ax, pcrp.ScaledDateNum,pcrp.NumericLevel, <span class="keyword">...</span>
0306             <span class="string">'Color'</span>, [0, 0.65, 1], <span class="keyword">...</span>
0307             <span class="string">'LineStyle'</span>, <span class="string">':'</span>, <span class="keyword">...</span>
0308             <span class="string">'Marker'</span>, <span class="string">'o'</span>, <span class="keyword">...</span>
0309             <span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
0310             <span class="string">'MarkerSize'</span>,2,<span class="keyword">...</span>
0311             <span class="string">'MarkerEdgeColor'</span>,<span class="string">'b'</span>,<span class="keyword">...</span>
0312             <span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
0313         
0314         title(ax, <span class="string">'Clinical CRP Level'</span>);
0315         xlabel(ax, <span class="string">'Days'</span>);
0316         ylabel(ax, <span class="string">'CRP Level'</span>);
0317         xlim(xl);
0318         rangelimit = <a href="setMinYDisplayRangeForMeasure.html" class="code" title="function [range] = setMinYDisplayRangeForMeasure(measure)">setMinYDisplayRangeForMeasure</a>(<span class="string">'ClinicalCRP'</span>);
0319         yl = <a href="setYDisplayRange.html" class="code" title="function [roundedrange] = setYDisplayRange(miny, maxy, lowrangelimit)">setYDisplayRange</a>(min(pcrp.NumericLevel), max(pcrp.NumericLevel), rangelimit);
0320         ylim(yl);
0321         <span class="keyword">for</span> a = 1:size(ivabset,1)
0322             fill(ax, [ivabset.Startdn(a) ivabset.Stopdn(a) ivabset.Stopdn(a) ivabset.Startdn(a)], <span class="keyword">...</span>
0323                       [yl(1) yl(1) yl(2) yl(2)], ivcol, <span class="string">'FaceAlpha'</span>, <span class="string">'0.1'</span>, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0324         <span class="keyword">end</span>
0325         <span class="keyword">for</span> a = 1:size(oralabset,1)
0326             fill(ax, [oralabset.Startdn(a) oralabset.Stopdn(a) oralabset.Stopdn(a) oralabset.Startdn(a)], <span class="keyword">...</span>
0327                       [yl(1) yl(1) yl(2) yl(2)], oralcol, <span class="string">'FaceAlpha'</span>, <span class="string">'0.1'</span>, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0328         <span class="keyword">end</span>
0329         <span class="keyword">for</span> a = 1:size(trplset,1)
0330             fill(ax, [trplset.Startdn(a), trplset.Startdn(a) + 1, trplset.Startdn(a) + 1, trplset.Startdn(a)] , <span class="keyword">...</span>
0331                       [yl(1) yl(1) yl(2) yl(2)], trplcol, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0332         <span class="keyword">end</span>
0333         <span class="keyword">for</span> a = 1:size(drugset,1)
0334             fill(ax, [drugset.Startdn(a), drugset.Startdn(a) + 1, drugset.Startdn(a) + 1, drugset.Startdn(a)], <span class="keyword">...</span>
0335                       [yl(1) yl(1) yl(2) yl(2)], drugcol, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0336         <span class="keyword">end</span>
0337         hold off;
0338     <span class="keyword">end</span>
0339     
0340     ax = subplot(cplotsdown, cplotsacross, 3,<span class="string">'Parent'</span>,sp3);
0341     ppft = cdPFT(cdPFT.ID == scid,:);
0342     ppft.ScaledDateNum = datenum(ppft.LungFunctionDate) - offset - poffset + 1;
0343     <span class="keyword">if</span> size(ppft,1) &gt; 0
0344         hold on;
0345         plot(ax, ppft.ScaledDateNum, ppft.CalcFEV1_, <span class="keyword">...</span>
0346             <span class="string">'Color'</span>, [0, 0.65, 1], <span class="keyword">...</span>
0347             <span class="string">'LineStyle'</span>, <span class="string">':'</span>, <span class="keyword">...</span>
0348             <span class="string">'Marker'</span>, <span class="string">'o'</span>, <span class="keyword">...</span>
0349             <span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
0350             <span class="string">'MarkerSize'</span>,2,<span class="keyword">...</span>
0351             <span class="string">'MarkerEdgeColor'</span>,<span class="string">'b'</span>,<span class="keyword">...</span>
0352             <span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
0353         title(ax, <span class="string">'Clinical FEV1%'</span>);
0354         xlabel(ax, <span class="string">'Days'</span>);
0355         ylabel(ax, <span class="string">'FEV1%'</span>);
0356         xlim(xl);
0357         rangelimit = <a href="setMinYDisplayRangeForMeasure.html" class="code" title="function [range] = setMinYDisplayRangeForMeasure(measure)">setMinYDisplayRangeForMeasure</a>(<span class="string">'ClinicalFEV1'</span>);
0358         yl = <a href="setYDisplayRange.html" class="code" title="function [roundedrange] = setYDisplayRange(miny, maxy, lowrangelimit)">setYDisplayRange</a>(min(ppft.CalcFEV1_), max(ppft.CalcFEV1_), rangelimit);
0359         ylim(yl);
0360         <span class="keyword">for</span> a = 1:size(ivabset,1)
0361             fill(ax, [ivabset.Startdn(a) ivabset.Stopdn(a) ivabset.Stopdn(a) ivabset.Startdn(a)], <span class="keyword">...</span>
0362                       [yl(1) yl(1) yl(2) yl(2)], ivcol, <span class="string">'FaceAlpha'</span>, <span class="string">'0.1'</span>, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0363         <span class="keyword">end</span>
0364         <span class="keyword">for</span> a = 1:size(oralabset,1)
0365             fill(ax, [oralabset.Startdn(a) oralabset.Stopdn(a) oralabset.Stopdn(a) oralabset.Startdn(a)], <span class="keyword">...</span>
0366                       [yl(1) yl(1) yl(2) yl(2)], oralcol, <span class="string">'FaceAlpha'</span>, <span class="string">'0.1'</span>, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0367         <span class="keyword">end</span>
0368         <span class="keyword">for</span> a = 1:size(trplset,1)
0369             fill(ax, [trplset.Startdn(a), trplset.Startdn(a) + 1, trplset.Startdn(a) + 1, trplset.Startdn(a)] , <span class="keyword">...</span>
0370                       [yl(1) yl(1) yl(2) yl(2)], trplcol, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0371         <span class="keyword">end</span>
0372         <span class="keyword">for</span> a = 1:size(drugset,1)
0373             fill(ax, [drugset.Startdn(a), drugset.Startdn(a) + 1, drugset.Startdn(a) + 1, drugset.Startdn(a)], <span class="keyword">...</span>
0374                       [yl(1) yl(1) yl(2) yl(2)], drugcol, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0375         <span class="keyword">end</span>
0376         hold off;
0377     <span class="keyword">end</span>
0378     
0379     <a href="savePlotInDir.html" class="code" title="function savePlotInDir(f, name, subfolder)">savePlotInDir</a>(f, imagefilename, subfolder);
0380     close(f);
0381     page = page + 1;
0382     fprintf(<span class="string">'Next Page\n'</span>);
0383     
0384     imagefilename = sprintf(<span class="string">'%s - Page %d of %d'</span>, filenameprefix, page, npages);
0385     [f, p] = <a href="createFigureAndPanel.html" class="code" title="function [f, p] = createFigureAndPanel(name, orientation, pagesize)">createFigureAndPanel</a>(imagefilename, <span class="string">'Portrait'</span>, <span class="string">'a4'</span>);
0386     
0387     <span class="comment">% plots for home measures on remaining pages</span>
0388     
0389     
0390     <span class="comment">% get all measures so the plots for each appear in a consistent place</span>
0391     <span class="comment">% across all patients</span>
0392     measures = unique(physdata.RecordingType);
0393     <span class="keyword">for</span> m = 1:size(measures,1)
0394         measure = measures{m};
0395         column = <a href="getColumnForMeasure.html" class="code" title="function [column] = getColumnForMeasure(measure)">getColumnForMeasure</a>(measure);
0396         scdata = physdata(physdata.SmartCareID == scid &amp; ismember(physdata.RecordingType, measure), :);
0397         scdata = scdata(:, {<span class="string">'SmartCareID'</span>,<span class="string">'ScaledDateNum'</span> <span class="string">'Date_TimeRecorded'</span>, column});
0398         scdata.Properties.VariableNames{column} = <span class="string">'Measurement'</span>;
0399         
0400         <span class="keyword">if</span> size(scdata,1) &gt; 0
0401             ax = subplot(mplotsdown, mplotsacross, m - (page-2) * mplotsperpage,<span class="string">'Parent'</span>,p);
0402             hold on;
0403             xlim(xl);
0404             rangelimit = <a href="setMinYDisplayRangeForMeasure.html" class="code" title="function [range] = setMinYDisplayRangeForMeasure(measure)">setMinYDisplayRangeForMeasure</a>(measure);
0405             yl = <a href="setYDisplayRange.html" class="code" title="function [roundedrange] = setYDisplayRange(miny, maxy, lowrangelimit)">setYDisplayRange</a>(min(scdata.Measurement), max(scdata.Measurement), rangelimit);
0406             ylim(yl);
0407             title(ax, replace(measure, <span class="string">'Recording'</span>, <span class="string">''</span>));
0408             xlabel(ax, <span class="string">'Days'</span>);
0409             ylabel(ax, <span class="string">'Measure'</span>);
0410             
0411             plot(ax, scdata.ScaledDateNum, scdata.Measurement, <span class="keyword">...</span>
0412                 <span class="string">'Color'</span>, [0, 0.65, 1], <span class="keyword">...</span>
0413                 <span class="string">'LineStyle'</span>, <span class="string">':'</span>, <span class="keyword">...</span>
0414                 <span class="string">'Marker'</span>, <span class="string">'o'</span>, <span class="keyword">...</span>
0415                 <span class="string">'LineWidth'</span>,1,<span class="keyword">...</span>
0416                 <span class="string">'MarkerSize'</span>,2,<span class="keyword">...</span>
0417                 <span class="string">'MarkerEdgeColor'</span>,<span class="string">'b'</span>,<span class="keyword">...</span>
0418                 <span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
0419             
0420             plot(ax, scdata.ScaledDateNum, movmean(scdata.Measurement, 4, <span class="string">'omitnan'</span>), <span class="keyword">...</span>
0421                 <span class="string">'Color'</span>, [0, 0.65, 1], <span class="keyword">...</span>
0422                 <span class="string">'LineStyle'</span>, <span class="string">'-'</span>, <span class="keyword">...</span>
0423                 <span class="string">'Marker'</span>, <span class="string">'none'</span>, <span class="keyword">...</span>
0424                 <span class="string">'LineWidth'</span>, 1);
0425             
0426             ddcolumn = sprintf(<span class="string">'Fun_%s'</span>,column);
0427             <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a> = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(5);
0428             <a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a> = demographicstable{demographicstable.SmartCareID == scid &amp; ismember(demographicstable.RecordingType, measure),{ddcolumn}}(6);
0429             line( xl, [<a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a> <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>] , <span class="string">'Color'</span>, <span class="string">'black'</span>, <span class="string">'LineStyle'</span>, <span class="string">'--'</span>, <span class="string">'LineWidth'</span>, 1)
0430             line( xl, [<a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>-<a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a> <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>-<a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a>] , <span class="string">'Color'</span>, <span class="string">'black'</span>, <span class="string">'LineStyle'</span>, <span class="string">':'</span>, <span class="string">'LineWidth'</span>, 1)
0431             line( xl, [<a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>+<a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a> <a href="mid50mean.html" class="code" title="function y = mid50mean(x)">mid50mean</a>+<a href="mid50std.html" class="code" title="function y = mid50std(x)">mid50std</a>] , <span class="string">'Color'</span>, <span class="string">'black'</span>, <span class="string">'LineStyle'</span>, <span class="string">':'</span>, <span class="string">'LineWidth'</span>, 1)
0432             
0433             <span class="keyword">for</span> a = 1:size(ivabset,1)
0434                 fill(ax, [ivabset.Startdn(a) ivabset.Stopdn(a) ivabset.Stopdn(a) ivabset.Startdn(a)], <span class="keyword">...</span>
0435                           [yl(1) yl(1) yl(2) yl(2)], ivcol, <span class="string">'FaceAlpha'</span>, <span class="string">'0.1'</span>, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0436             <span class="keyword">end</span>
0437             <span class="keyword">for</span> a = 1:size(oralabset,1)
0438                 fill(ax, [oralabset.Startdn(a) oralabset.Stopdn(a) oralabset.Stopdn(a) oralabset.Startdn(a)], <span class="keyword">...</span>
0439                           [yl(1) yl(1) yl(2) yl(2)], oralcol, <span class="string">'FaceAlpha'</span>, <span class="string">'0.1'</span>, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0440             <span class="keyword">end</span>
0441             <span class="keyword">for</span> a = 1:size(trplset,1)
0442             fill(ax, [trplset.Startdn(a), trplset.Startdn(a) + 1, trplset.Startdn(a) + 1, trplset.Startdn(a)] , <span class="keyword">...</span>
0443                          [yl(1) yl(1) yl(2) yl(2)], trplcol, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0444             <span class="keyword">end</span>
0445             <span class="keyword">for</span> a = 1:size(drugset,1)
0446                 fill(ax, [drugset.Startdn(a), drugset.Startdn(a) + 1, drugset.Startdn(a) + 1, drugset.Startdn(a)], <span class="keyword">...</span>
0447                          [yl(1) yl(1) yl(2) yl(2)], drugcol, <span class="string">'EdgeColor'</span>, <span class="string">'none'</span>);
0448             <span class="keyword">end</span>
0449             hold off;
0450         <span class="keyword">end</span>
0451         
0452         <span class="keyword">if</span> round(m/mplotsperpage) == m/mplotsperpage
0453             <a href="savePlotInDir.html" class="code" title="function savePlotInDir(f, name, subfolder)">savePlotInDir</a>(f, imagefilename, subfolder);
0454             close(f);
0455             page = page + 1;
0456             fprintf(<span class="string">'Next Page\n'</span>);
0457             imagefilename = sprintf(<span class="string">'%s - Page %d of %d'</span>, filenameprefix, page, npages);
0458             [f, p] = <a href="createFigureAndPanel.html" class="code" title="function [f, p] = createFigureAndPanel(name, orientation, pagesize)">createFigureAndPanel</a>(imagefilename, <span class="string">'Portrait'</span>, <span class="string">'a4'</span>);
0459         <span class="keyword">end</span>
0460     <span class="keyword">end</span>
0461     
0462     <span class="keyword">if</span> exist(<span class="string">'f'</span>, <span class="string">'var'</span>)
0463         <a href="savePlotInDir.html" class="code" title="function savePlotInDir(f, name, subfolder)">savePlotInDir</a>(f, imagefilename, subfolder);
0464         close(f);
0465     <span class="keyword">end</span>
0466 
0467     toc
0468     
0469 <span class="keyword">end</span>
0470 
0471     
0472</pre></div>
<hr><address>Generated on Thu 26-Aug-2021 19:28:55 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>